"use strict";(self.webpackChunkmatols_website=self.webpackChunkmatols_website||[]).push([[142],{5142:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var a=s(3216),r=s(6316),n=s(5043),o=s(8386),l=s(1569),c=s(6140),i=s(2820),d=s(524),u=s(2780),m=s(2907),x=s(6007),p=s(5624),f=s(7613),h=s(579);function g(){const{id:e}=(0,a.g)(),t=(0,m.useQueryClient)(),[s,g]=(0,n.useState)(!1),b=(0,r.h)([]),y=(0,c.J)(b.push),{data:v,isComputeDistanceLoading:j,isComputeDistanceError:w,computeDistanceError:N,computeDistanceAsync:k}=(0,d.Q)(g),{data:S,error:_,isError:C,isLoading:R}=(0,m.useQuery)({queryKey:["fetch-update-routes"],queryFn:()=>(0,x.SH)(e),onSuccess:e=>{b.set(e.pickup_dropoff_routes)}}),{isLoading:D,isSuccess:I,mutateAsync:O,isError:A,error:E}=(0,m.useMutation)("update-routes",{mutationFn:x.Du,onSuccess:e=>{g((e=>!1)),t.invalidateQueries(["fetch-update-routes"])},onMutate:e=>{g((e=>!0))},onError:e=>{g((e=>!1))}});return R?(0,h.jsx)(p.q,{secondary_text:"loading booking vehicle type"}):C?(0,h.jsx)(f.$,{secondaryText:"".concat(_.response.data)}):(0,h.jsx)("main",{className:"max-w-xl mx-auto p-6 my-6 text-black bg-white",children:(0,h.jsxs)("div",{className:"rounded-lg p-6 shadow-sm border border-gray-200",children:[(0,h.jsxs)("h2",{className:"text-start text-black px-2 font-extrabold text-3xl",children:["Update Pick up and drop off locations",(0,h.jsx)("p",{className:"text-sm font-normal text-slate-600 pt-2",children:"Trust matols logistics services to transport your items safely."}),(0,h.jsxs)("p",{className:"text-sm font-bold pt-2",children:["Booking ",e]})]}),(0,h.jsx)(o.b,{useArrayOutput:b,disableUserInterface:s}),(0,h.jsx)(l.K,{useRoutesOutput:y,disableUserInterface:s,setDisableUserInterface:g}),(0,h.jsxs)("div",{children:[w&&(0,h.jsx)(f.$,{className:"mb-4",secondaryText:"".concat(N.response.data.message," ").concat(N.message)}),A&&(0,h.jsx)(f.$,{className:"mb-4",secondaryText:"".concat(E.response.data.message," ").concat(E.message)}),I&&(0,h.jsx)(f.C,{secondaryText:"Booking pick up and drop off locations successfully updated",className:"mb-4"})]}),(0,h.jsx)("div",{className:"px-2 py-4 flex justify-end",children:(0,h.jsx)(i.$,{disabled:b.array.length<1,className:"w-auto",onClick:async()=>{if(!(b.array.length<1))try{await k({pickup_dropoff_routes:b.array}).then((async e=>{try{const t={id:S.id,distance:Number(e.distance),pickup_dropoff_routes:b.array};await O(t)}catch(t){}}))}catch(e){}},children:j||D?(0,h.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,h.jsx)(u.LW,{visible:!0,width:"40",height:"20",color:"#000"})}):"Update"})})]})})}},7613:(e,t,s)=>{s.d(t,{$:()=>o,C:()=>n});s(5043);var a=s(4694),r=s(579);function n(e){let{secondaryText:t,className:s,children:n,...o}=e;return(0,r.jsx)("div",{...o,className:(0,a.cn)("bg-green-100 border-t-4 border-green-500 rounded-b-md text-green-900 px-4 py-2",s),role:"alert",children:(0,r.jsx)("div",{className:"flex text-wrap break-words",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold",children:"Yey ! all set"}),(0,r.jsx)("p",{className:"text-sm text-wrap break-words",children:t||"Welcome to Matols Logistics services"})]})})})}function o(e){let{secondaryText:t,className:s,children:n,...o}=e;return(0,r.jsx)("div",{...o,className:(0,a.cn)("bg-red-100 border-t-4 border-red-500 rounded-b-lg text-red-900 px-4 py-2",s),role:"alert",children:(0,r.jsx)("div",{className:"flex",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold",children:"Oops ! Error"}),(0,r.jsx)("p",{className:"text-sm",children:t||"An error occured"})]})})})}},8386:(e,t,s)=>{s.d(t,{b:()=>d});var a=s(5043),r=s(4858),n=s(4694),o=s(579);const l=a.forwardRef(((e,t)=>{let{className:s,route:a,routeIndex:l,updateRoute:c,toggleRouteDetailVisibility:i,disableUserInterface:d,...u}=e;const{register:m,handleSubmit:x,reset:p}=(0,r.mN)();return(0,o.jsxs)("form",{...u,ref:t,className:(0,n.cn)("w-full hidden",s),onSubmit:x((e=>{const t={...a,...e};console.log(t),c(l,{...a,...e}),i(),p()})),children:[(0,o.jsx)("div",{children:(0,o.jsx)("input",{...m("route_detail",{disabled:d}),type:"text",name:"route_detail",placeholder:"Please enter details",className:(0,n.cn)("text-sm text-slate-800  w-full relative shadow-sm block rounded-lg border-gray-200 focus:z-10 focus:ring-yellow-400 focus:border-yellow-400 disabled:opacity-50 disabled:pointer-events-none")})}),(0,o.jsx)("div",{className:"w-full flex flex-row justify-end items-center px-2 pt-2",children:(0,o.jsx)("button",{type:"submit",className:"text-green-700 text-sm font-bold hover:text-opacity-60 disabled:pointer-events-none disabled:opacity-60",children:"Done"})})]})}));var c=s(6720);function i(e){let{routeIndex:t,route:s,updateRoute:r,removeRoute:i,disableUserInterface:d,...u}=e;const[m,x]=(0,a.useState)(!1),p=new a.useRef(null),f=()=>{var e;const t=null===p||void 0===p||null===(e=p.current)||void 0===e?void 0:e.classList;t.contains("hidden")?(x((e=>!0)),t.remove("hidden")):(x((e=>!1)),t.add("hidden"))};return(0,o.jsxs)("div",{...u,children:[(0,o.jsxs)("div",{className:"flex flex-col border border-gray-200 px-3 py-2 rounded-lg ",children:[(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsxs)("p",{className:"text-sm font-bold",children:[s.primary_text,","," ",(0,o.jsx)("span",{className:"font-normal",children:s.secondary_text})]}),s.route_detail&&(0,o.jsx)("p",{className:"text-gray-500 text-sm",children:s.route_detail})]}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{disabled:d,onClick:()=>i(t),className:"text-red-700 font-bold ml-3",children:(0,o.jsx)(c.uDv,{size:20,className:"text-red-500"})})]}),(0,o.jsx)(l,{ref:p,className:"mt-3",route:s,updateRoute:r,routeIndex:t,toggleRouteDetailVisibility:f,disableUserInterface:d})]}),(0,o.jsx)("div",{className:"w-full flex flex-row justify-end items-center px-2 py-1",children:(0,o.jsx)("button",{disabled:d,onClick:f,className:(0,n.cn)("text-yellow-400 text-sm font-bold hover:text-opacity-60",{"text-red-700":m}),children:m?"Cancel":"Add detail"})})]})}function d(e){let{useArrayOutput:t,disableUserInterface:s}=e;const{array:a,update:r,remove:n}=t;return(0,o.jsx)("div",{className:"p-2",children:a.map(((e,t)=>(0,o.jsx)(i,{className:"mb-1",routeIndex:t,route:e,updateRoute:r,removeRoute:n,disableUserInterface:s},t)))})}},1569:(e,t,s)=>{s.d(t,{K:()=>l});var a=s(5043),r=s(4694),n=s(5394),o=s(579);function l(e){let{disableUserInterface:t,useRoutesOutput:s,setDisableUserInterface:l,...c}=e;const i=(0,a.useRef)(),{data:d,status:u,handleRouteSelect:m,search:x}=s,p=(0,a.useRef)(null),f=e=>{e?p.current.classList.remove("hidden"):p.current.classList.add("hidden")};return(0,a.useEffect)((()=>{f("OK"===u)}),[u]),(0,o.jsx)("div",{className:"px-2",children:(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{ref:i,...c,disabled:t,type:"text",placeholder:"Search location",onChange:e=>{x(e.currentTarget.value)},className:(0,r.cn)("text-sm text-slate-800 w-full shadow-sm block rounded-lg border-gray-200 focus:z-10 focus:ring-yellow-400 focus:border-yellow-400 disabled:opacity-50 disabled:pointer-events-none",{})}),(0,o.jsx)("div",{ref:p,className:"hidden",children:(0,o.jsx)("ul",{className:"w-full rounded-md bg-white shadow-lg border border-gray-200rounded-lg absolute top-12 flex flex-col justify-center items-start",children:null===d||void 0===d?void 0:d.map(((e,t)=>(0,o.jsxs)("li",{className:"border-b border-gray-200 px-2 py-2 bg-gray-100 flex w-full gap-1",onClick:m(e,i,l),children:[(0,o.jsx)("div",{children:(0,o.jsx)(n.eVO,{size:15,className:"text-gray-400"})}),(0,o.jsxs)("p",{className:"text-xs text-black font-bold",children:[e.structured_formatting.main_text,","," ",(0,o.jsx)("span",{className:"font-normal",children:e.structured_formatting.secondary_text})]})]},t)))})})]})})}},5624:(e,t,s)=>{s.d(t,{q:()=>n});var a=s(2780),r=s(579);function n(e){let{secondary_text:t}=e;return(0,r.jsxs)("div",{className:"m-auto max-w-4xl flex flex-col justify-center items-center py-48 my-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center gap-4",children:[(0,r.jsx)("span",{children:"Please be patient"}),(0,r.jsx)("span",{children:t})]}),(0,r.jsx)(a.LW,{visible:!0,width:"40",height:"20",color:"#000"})]})}},6316:(e,t,s)=>{s.d(t,{h:()=>r});var a=s(5043);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const[t,s]=(0,a.useState)(e);return{array:t,push:e=>{s((t=>[...t,e]))},filter:e=>{s((t=>t.filter(e)))},update:(e,t)=>{s((s=>[...s.slice(0,e),t,...s.slice(e+1,s.length)]))},remove:e=>{s((t=>[...t.slice(0,e),...t.slice(e+1,t.length)]))},clear:()=>{s([])},set:e=>{s((t=>e))}}}},524:(e,t,s)=>{s.d(t,{Q:()=>n});var a=s(2907),r=s(6007);function n(e){const{data:t,isLoading:s,isSuccess:n,mutateAsync:o,isError:l,error:c}=(0,a.useMutation)({mutationKey:"compute-distance",mutationFn:r.rn,onMutate:t=>{e((e=>!0))},onSuccess:t=>{e((e=>!1))},onError:t=>{e((e=>!1))}});return{data:t,isComputeDistanceLoading:s,isComputeDistanceSuccess:n,isComputeDistanceError:l,computeDistanceError:c,computeDistanceAsync:o}}},6140:(e,t,s)=>{s.d(t,{J:()=>i});var a=s(5043);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},r.apply(this,arguments)}var n=function(e){var t=(0,a.useRef)(e);return t.current=e,t},o=function(e){var t=void 0===e?{}:e,s=t.requestOptions,o=t.debounce,l=void 0===o?200:o,c=t.cache,i=void 0===c?86400:c,d=t.cacheKey,u=void 0===d?"upa":d,m=t.googleMaps,x=t.callbackName,p=t.defaultValue,f=void 0===p?"":p,h=t.initOnMount,g=void 0===h||h,b=(0,a.useState)(!1),y=b[0],v=b[1],j=(0,a.useState)(f),w=j[0],N=j[1],k=(0,a.useState)({loading:!1,status:"",data:[]}),S=k[0],_=k[1],C=(0,a.useRef)(),R=n(s),D=n(m),I=(0,a.useCallback)((function(){var e;if(!C.current){var t=window.google,s=D.current,a=(null==s?void 0:s.places)||(null==t||null==(e=t.maps)?void 0:e.places);a?(C.current=new a.AutocompleteService,v(!0)):console.error("\ud83d\udca1 use-places-autocomplete: Google Maps Places API library must be loaded. See: https://github.com/wellyshen/use-places-autocomplete#load-the-library")}}),[D]),O=(0,a.useCallback)((function(){_({loading:!1,status:"",data:[]})}),[]),A=(0,a.useCallback)((function(e){void 0===e&&(e=u);try{sessionStorage.removeItem(e)}catch(t){}}),[u]),E=(0,a.useCallback)(function(e,t){var s;return function(){for(var a=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];null!==s&&(clearTimeout(s),s=null),s=setTimeout((function(){return e.apply(a,n)}),t)}}((function(e){var t;if(e){_((function(e){return r({},e,{loading:!0})}));var s={};try{s=JSON.parse(sessionStorage.getItem(u)||"{}")}catch(a){}i&&(s=Object.keys(s).reduce((function(e,t){return s[t].maxAge-Date.now()>=0&&(e[t]=s[t]),e}),{}))[e]?_({loading:!1,status:"OK",data:s[e].data}):null==(t=C.current)||t.getPlacePredictions(r({},R.current,{input:e}),(function(t,r){if(_({loading:!1,status:r,data:t||[]}),i&&"OK"===r){s[e]={data:t,maxAge:Date.now()+1e3*i};try{sessionStorage.setItem(u,JSON.stringify(s))}catch(a){}}}))}else O()}),l),[i,u,O,R]),U=(0,a.useCallback)((function(e,t){void 0===t&&(t=!0),N(e),C.current&&t&&E(e)}),[E]);return(0,a.useEffect)((function(){if(!g)return function(){return null};var e=window.google;return D.current||null!=e&&e.maps||!x?I():window[x]=I,function(){window[x]&&delete window[x]}}),[x,D,I,g]),{ready:y,value:w,suggestions:S,setValue:U,clearSuggestions:O,clearCache:A,init:I}},l=function(e){var t=new window.google.maps.Geocoder;return new Promise((function(s,a){t.geocode(e,(function(t,r){"OK"!==r&&a(r),!e.address&&e.componentRestrictions&&(console.error("\ud83d\udca1 use-places-autocomplete: Please provide an address when using getGeocode() with the componentRestrictions."),s(t)),s(t)}))}))},c=function(e){var t=e.geometry.location,s=t.lat,a=t.lng;return{lat:s(),lng:a()}};function i(e){const{value:t,setValue:s,clearSuggestions:a,suggestions:{data:r,status:n}}=o({callbackName:"onInit",requestOptions:{componentRestrictions:{country:"za"}},debounce:100});return{data:r,status:n,handleRouteSelect:(t,r,n)=>{let{description:o,structured_formatting:i}=t;return async()=>{n((e=>!0));try{s(o,!1),a(),await l({address:o}).then((t=>{const{main_text:s,secondary_text:a}=i,{lat:o,lng:l}=c(t[0]);e({purpose:"Pick up or Drop off",route_detail:"",primary_text:s,secondary_text:a,lat:o,lng:l}),r&&(r.current.value=""),n((e=>!1))}))}catch(t){}}},search:s}}}}]);
//# sourceMappingURL=142.7ddd6dbe.chunk.js.map